{% extends 'base.html.twig' %}

{% block title %}{{ post.title }}{% endblock %}

{% block body %}
  <a href="{{ path('article_index') }}">← Retour</a>

  <h1 class="mt-3">{{ post.title }}</h1>

  <p class="text-muted">
    Publié le {{ post.publishedAt ? post.publishedAt|date('d/m/Y H:i') : '' }}
  </p>

  {% if post.picture %}
    <img src="{{ post.picture }}" alt="" class="img-fluid rounded mb-3">
  {% endif %}

  <div class="mb-4">
    {{ post.content|nl2br }}
  </div>

  <hr class="my-4">

<h2>Commentaires</h2>

{% if post.comments is empty %}
  <p>Aucun commentaire.</p>
{% else %}
  <ul class="list-group mb-3">
    {% for c in post.comments %}
      <li class="list-group-item">
        <div class="small text-muted">
          {{ c.author ? c.author.email : 'Anonyme' }} — {{ c.createdAt|date('d/m/Y H:i') }}
        </div>
        <div>{{ c.content|nl2br }}</div>
      </li>
    {% endfor %}
  </ul>
{% endif %}

{% if app.user %}
  <h3>Ajouter un commentaire</h3>
  {{ form_start(commentForm) }}
    {{ form_row(commentForm.content) }}
    <button class="btn btn-primary">Envoyer</button>
  {{ form_end(commentForm) }}
{% else %}
  <p>
    <a href="{{ path('app_login') }}">Connecte-toi</a> pour ajouter un commentaire.
  </p>
{% endif %}
{% endblock %}